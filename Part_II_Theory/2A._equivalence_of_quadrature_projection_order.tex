
\chapter{Equivalence of Quadrature-Projection Order\label{chpt:equivalence-of-quadrature-projection-order}}


\section{Gaussian quadrature\label{sec:Gaussian-quadrature}}


\subsection*{\uline{Theorem:} }

<<<<<<< HEAD
Let $P_{n}(x)$ be a nonzero polynomial of degree $n$, and $w(x)$
a positive weight function so that
=======
Let $P_{n}(x)$ be a nonzero polynomial of degree $n$, and $w(x)$ a
positive weight function so that
>>>>>>> ad9ea55e089e5d298a1fe1f029f87668816e4938
\begin{equation}
\int_{a}^{b}x^{k}P_{n}(x)w(x)\mathrm{d}x=0,(k=0,\ldots,n-1)
\end{equation}


If $\left\{ x_{i}\right\} (i=1,\ldots n)$ are the zeros of $P_{n}(x)$,
then
\begin{equation}
\int_{a}^{b}f(x)w(x)\mathrm{d}x\simeq\sum_{i=1}^{n}A_{i}f(x_{i})
\end{equation}
with
\begin{equation}
A_{i}=\int_{a}^{b}l_{i-1}(x)w(x)\mathrm{d}x
\end{equation}
is exact for all polynomials $f(x)$ of degree at most $2n-1$, where
$\left\{ l_{i}\right\} $ are the usual Lagrange interpolating polynomials.


\subsection*{\uline{Proof: }}

Assume that $f(x)$ is a polynomial of degree at most $2n-1$. Using
long division
\begin{equation}
f(x)=P_{n}(x)p(x)+r(x)
\end{equation}
$p(x)$ and $r(x)$ are obtained as polynomials of degree at most
$n-1$.

By taking $\left\{ x_{i}\right\} $ as the zeros of $P_{n}(x)$, we
can easily find $f(x_{i})=r(x_{i}),(i=1,\ldots n)$, then
\begin{eqnarray}
\int_{a}^{b}f(x)w(x)\mathrm{d}x & = & \int_{a}^{b}\left[P_{n}(x)p(x)+r(x)\right]w(x)\mathrm{d}x\nonumber \\
 & \simeq & \stackrel{=0}{\overbrace{\sum_{i=1}^{n}P_{n}(x_{i})p(x_{i})w_{i}}}+\sum_{i=1}^{n}A_{i}r(x_{i})
\end{eqnarray}
is exact for $r(x)$ of degree at most $n-1$ (c.f. Numerical Recipes
<<<<<<< HEAD
\citep{Numerical_Recipes_3ed} p.118), and thus exact for $f(x)$
of degree at most $2n-1$.
=======
\citep{Numerical_Recipes_3ed} p.118), and thus exact for $f(x)$ of degree
at most $2n-1$.
>>>>>>> ad9ea55e089e5d298a1fe1f029f87668816e4938


\section{Angular integration in GSHT}

To expand a function onto GSHs, as in eq. (\ref{eq:GSHT_forward}),
quadrature is needed. Assume that $F(\mathbf{\Omega})$ is a polynomial
of $\cos\Theta$, with $\cos\Phi$ and $\cos\Psi$ of order $n$. As $R_{\mu'\mu}^{m*}(\mathbf{\Omega})$
is also a polynomial of order $n$, the total degree of integrand
<<<<<<< HEAD
is $2n$. It should be noted that the surface area element is:
=======
is $2n$. It should be noted that the surface area element is derived from:
>>>>>>> ad9ea55e089e5d298a1fe1f029f87668816e4938
\begin{equation}
\mathrm{d}\mathbf{\Omega}=\sin\Theta\mathrm{d}\Theta\mathrm{d}\Phi\mathrm{d}\Psi=\mathrm{d}\cos\Theta\mathrm{d}\Phi\mathrm{d}\Psi
\end{equation}


For $\cos\Theta$ integration, considering $w(x)=1$ and $x=\cos\Theta$,
Gauss-Legendre quadrature should be used. Thus $n+1$ points on $x$
should be taken, with $\left\{ x_{i}\right\} $ given by Legendre
polynomials $P_{n+1}(x).$

For $\Phi$ and $\Psi$ integration, taking $w(x)=\left(1-x^{2}\right)^{-\frac{1}{2}}$,
the abscissae are given by the $N=n+1$ roots of the Chebyshev polynomial
of the first kind:
\begin{equation}
\begin{array}{cccc}
T_{N}(x)=\cos(N\cos x) & \Rightarrow & x_{i}=\cos\left[\frac{(2i-1)\pi}{2N}\right], & i\in1,\ldots,N\end{array}
\end{equation}
<<<<<<< HEAD
with weight $w_{i}=\frac{\pi}{N}$, it corresponds to points in $\Phi\in\left[0,\pi\right]$
=======
With weight $w_{i}=\frac{\pi}{N}$, it corresponds to points in $\Phi\in\left[0,\pi\right]$
>>>>>>> ad9ea55e089e5d298a1fe1f029f87668816e4938
regularly distributed. However, for $\Phi\in\left[0,2\pi\right]$,
two times of function evaluation should be calculated:
\begin{align}
 & \int_{-1}^{1}f(\cos\Phi)\frac{1}{\sqrt{1-\cos^{2}\Phi}}\mathrm{d}\cos\Phi\nonumber \\
= & \begin{cases}
\int_{\pi}^{0}f(\cos\Phi)\mathrm{d}\Phi=\text{-}\int_{0}^{\pi}f(\cos(\Phi))\mathrm{d}\Phi & \Phi\in[0,\pi]\\
\int_{-\pi}^{0}f(\cos(\Phi))\mathrm{d}(\Phi)=\int_{0}^{\pi}f(\cos(\text{-}\Phi'))\mathrm{d}\Phi' & \Phi'\in[0,\pi]
\end{cases}
\end{align}
so that
\begin{equation}
\int_{0}^{2\pi}f(\cos\Phi)\mathrm{d}\Phi=\int_{-\pi}^{\pi}f(\cos\Phi)\mathrm{d}\Phi=\int_{0}^{\pi}\left[f(\cos(-\Phi))-f(\cos\Phi)\right]\mathrm{d}\Phi
\end{equation}


It corresponds to $2n+2$ points in $\Phi\in\left[0,2\pi\right]$
regularly distributed. However, it's not the minimal number of points
necessary to do the exact integration. Suppose that $\Phi_{2}\equiv\Phi/2$,
\begin{equation}
\int_{0}^{2\pi}f(\cos\Phi)\mathrm{d}\Phi=\int_{0}^{\pi}f(\cos(2\Phi_{2}))\mathrm{d}\Phi_{2}=\int_{0}^{\pi}\left[f(2\cos^{2}\Phi_{2}-1)\right]\mathrm{d}\Phi_{2}
\end{equation}


As $f(2\cos^{2}\Phi_{2}-1)$ is a polynomial of $\Phi$ of degree
$2n$, it's a polynomial of $\Phi_{2}$ of degree $4n$. Thus only
$2n+1$ points are needed.
