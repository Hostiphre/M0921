
\chapter{Solvation Structure\label{chpt:solvation-structure}}

In MDFT, all the information about solvation structure can be deduced
from the solvent density $\rho(\mathbf{r},\mathbf{\Omega})$. This
section presents some examples of structure which are used in later
chapters.

\section{Radial distribution function and site-site distribution function}

When the solvent is homogeneous, the \acs{PDF} can be reduced to
$g(r_{12})$, which is sometimes referred to as the radial distribution
function (\acs{RDF}). However, it is also used as a key character
of the structure for inhomogeneous fluids, which can be calculated
equivalently as:
\begin{equation}
g(r)=\left\langle \rho(r,\hat{\mathbf{r}})\right\rangle =\dfrac{\int\rho(r,\hat{\mathbf{r}})\mathrm{d}s_{r}}{\int\mathrm{d}s_{r}}
\end{equation}

To do this integration, it is required to transform $\rho(\mathbf{r},\mathbf{\Omega})$
into spherical coordinates. But as $\rho(\mathbf{r},\mathbf{\Omega})$
in the code is a $N$-point discrete space grid:
\begin{equation}
\rho(\mathbf{r})=\int\mathrm{d}\mathbf{\Omega}\rho(\mathbf{r},\mathbf{\Omega})=\sum_{i=1}^{N}\rho_{i}\delta(\mathbf{r}-\mathbf{r}_{i})
\end{equation}
The best way to do the integration is to use a histogram approach.

The grid points are assumed to be homogenous in space, such that the
number of points entering in an arbitrary volume $v$ is proportional
to this volume. Obviously the grid of $\rho(\mathbf{r},\mathbf{\Omega})$
satisfies this assumption.

The average value of $g(r)$ between an interval $\delta r$ is
\begin{equation}
g(r_{i})=\left\langle g(r)\right\rangle _{r}^{r+\delta r}=\dfrac{\int_{r}^{r+\delta r}g(r)\mathrm{d}r}{\delta r}
\end{equation}

Thus
\begin{equation}
g(r_{i})=\dfrac{1}{\delta v_{i}}\int_{r}^{r+\delta r}\int_{s}\rho(r,\hat{\mathbf{r}})\mathrm{d}r\mathrm{d}s_{r}=\dfrac{1}{\delta v_{i}}\int_{v_{i}}\sum_{i=1}^{N}\rho_{i}\delta(\mathbf{r}-\mathbf{r}_{i})\mathrm{d}v_{i}
\end{equation}
where $\delta v_{i}=\delta r\cdot s_{r_{i}}=\int_{v_{i}}\delta(\mathbf{r}-\mathbf{r}_{i})\mathrm{d}v_{i}$
(as the points are homogeneous). 

The total function is 
\begin{equation}
g(r_{i})=\dfrac{\int_{v_{i}}\sum_{i=1}^{N}\rho_{i}\delta(\mathbf{r}-\mathbf{r}_{i})\mathrm{d}v_{i}}{\int_{v_{i}}\delta(\mathbf{r}-\mathbf{r}_{i})\mathrm{d}v_{i}}
\end{equation}
and it becomes necessary to sum up the point values $\rho_{i}$ in the interval
$\delta v=\delta r\cdot S_{r}$, and divide it by the number of points
in this interval.

A site-site distribution function is the same type as \acs{RDF},
but the origin for the calculation of $\mathbf{r}$ is no longer at
the center of the solute, but is now at the site coordinate $\mathbf{r}_{u}$, such
that the new coordinates are calculated as $\mathbf{r}'=\mathbf{r}-\mathbf{r}_{u}$.
Calculation of solvent site outside the solvent center requires more
complicated calculations, involving the rotation of solvent coordinate
to $\mathbf{\Omega}$-frame. It has equivant information of the structure
to the rotational invariant projections of higher order, the implementation of which
we have not done here.

\section{Radial polarization functions}

Radial polarization function (RPF) is defined as 
\begin{equation}
p(r)=\left\langle P(r,\hat{\mathbf{r}})\right\rangle 
\end{equation}
where $P(\mathbf{r})$ is the polarization $P(\mathbf{r})=\int\mathbf{\Omega}\cdot\rho(\mathbf{r},\mathbf{\Omega})\mathrm{d}\mathbf{\Omega}$.
It can be calculated in the same way as $g(r)$.

\section{Rotational invariant expansion}

The density can be expanded on rotational invariants:
\begin{eqnarray}
\rho(\mathbf{r},\mathbf{\Omega}) & = & \sum_{mnl\mu\nu}\rho_{\mu\nu}^{mnl}(r)\Phi_{\mu\nu}^{mnl}(0,\mathbf{\Omega},\mathbf{\hat{r}})\label{eq:rot_invar_expansion}\\
 & = & \sum_{mnl\mu\nu}\rho_{\mu\nu}^{mnl}(r)f^{m}f^{n}\sum_{\eta}\left(\begin{array}{ccc}
m & n & l\\
\mu & \eta & -\mu-\eta
\end{array}\right)R_{\eta\nu}^{n}(\mathbf{\Omega})R_{-\mu-\eta,0}^{l}(\mathbf{\hat{r}})
\end{eqnarray}

The forward transform is shown below:
\begin{equation}
\rho_{\mu\nu}^{mnl}(r)=f^{m}f^{n}\sum_{\eta}\left(\begin{array}{ccc}
m & n & l\\
\mu & \eta & -\mu-\eta
\end{array}\right)\int\mathrm{d}\hat{\mathbf{r}}R_{-\mu-\eta,0}^{l*}(\mathbf{\hat{r}})\int\mathrm{d}\mathbf{\Omega}\rho(r,\hat{\mathbf{r}},\mathbf{\Omega})R_{\eta,\nu}^{n*}(\mathbf{\Omega})
\end{equation}

A detailed deduction for this generalized formula is in appendix \ref{chpt:rotational-invariant-expansion}.

\section{Equivalence between the curves}

The relation between these curves can be proven mathematically.

Firstly, as
\begin{equation}
\Phi_{00}^{000}(\mathbf{r},\mathbf{\Omega})=1
\end{equation}
there is only one expansion term in eq. (\ref{eq:rot_invar_expansion}).
The projection is
\begin{equation}
\rho_{00}^{000}(r)=\rho(\mathbf{r},\mathbf{\Omega})=g(r)
\end{equation}

Then,
\begin{eqnarray}
\Phi_{00}^{011}(\mathbf{r},\mathbf{\Omega}) & = & \sqrt{3}\left(\begin{array}{ccc}
0 & 1 & 1\\
0 & 0 & 0
\end{array}\right)R_{00}^{1}(\mathbf{\Omega})R_{00}^{1}(\mathbf{\hat{r}})\nonumber \\
 & + & \sqrt{3}\left(\begin{array}{ccc}
0 & 1 & 1\\
0 & 1 & -1
\end{array}\right)R_{10}^{1}(\mathbf{\Omega})R_{-10}^{1}(\mathbf{\hat{r}})\nonumber \\
 & + & \sqrt{3}\left(\begin{array}{ccc}
0 & 1 & 1\\
0 & -1 & 1
\end{array}\right)R_{-10}^{1}(\mathbf{\Omega})R_{10}^{1}(\mathbf{\hat{r}})
\end{eqnarray}
such that
\begin{eqnarray}
\Phi_{00}^{011}(\mathbf{r},\mathbf{\Omega}) & = & -3R_{00}^{1}(\mathbf{\Omega})R_{00}^{1}(\mathbf{\hat{r}})\nonumber \\
 & + & 3R_{10}^{1}(\mathbf{\Omega})R_{-10}^{1}(\mathbf{\hat{r}})\nonumber \\
 & + & 3R_{-10}^{1}(\mathbf{\Omega})R_{10}^{1}(\mathbf{\hat{r}})\\
 & = & -3\mathbf{\Omega}\cdot\hat{\mathbf{r}}
\end{eqnarray}
with $R_{00}^{1}(\mathbf{\Omega})=\cos\theta$ and $R_{10}^{1}(\mathbf{\Omega})=-\frac{1}{\sqrt{2}}\sin\theta e^{-i\phi}$.

We can see
\begin{equation}
\rho_{00}^{011}(r)=\dfrac{\int\mathrm{d}\hat{\mathbf{r}}\mathrm{d}\mathbf{\Omega}\rho(\mathbf{r},\mathbf{\Omega})\Phi_{00}^{011*}(\mathbf{r},\mathbf{\Omega})}{\int\mathrm{d}\hat{\mathbf{r}}\mathrm{d}\mathbf{\Omega}\left\Vert \Phi_{00}^{011}(\mathbf{r},\mathbf{\Omega})\right\Vert ^{2}}=-\dfrac{1}{3}\dfrac{\int\mathrm{d}\hat{\mathbf{r}}P(\mathbf{r})\cdot\hat{\mathbf{r}}}{\int\mathrm{d}\hat{\mathbf{r}}\mathrm{d}\mathbf{\Omega}\left\Vert \mathbf{\Omega}\cdot\hat{\mathbf{r}}\right\Vert ^{2}}
\end{equation}
... (yes, in the implementation we see they are different curves.
No exact equivalence.)
